<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Tamil Crackers - Price List</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --brand: #d32f2f;
    --brand2:#ff9800;
    --gold:#ffd54f;
    --ink:#222;
    --paper: rgba(255,255,255,0.9);
  }
  *{box-sizing:border-box;}
  html,body{margin:0;padding:0;}
  body {
    font-family: Arial, Helvetica, sans-serif;
    color: #fff;
    background: url("bg.crackers.jpg") no-repeat center center fixed;
    background-size: cover;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  .wrap{
    width: 95%;
    max-width: 980px;
    margin: 24px auto;
    background: rgba(0,0,0,0.55);
    border-radius: 16px;
    padding: 20px;
    box-shadow: 0 12px 30px rgba(0,0,0,.35);
    overflow-x: auto;
  }
  header{
    text-align:center;
    margin-bottom:14px;
  }
  header h1{
    margin: 0 0 4px 0;
    font-size: 40px;
    color: var(--gold);
    text-shadow: 0 2px 8px #000;
  }
  header p{margin:2px 0 0 0;font-size:14px;}
  .card{
    background: var(--paper);
    color: var(--ink);
    border-radius: 14px;
    padding: 14px;
    box-shadow: 0 6px 20px rgba(0,0,0,.18);
    overflow-x: auto;
  }
  table{
    width:100%;
    border-collapse: collapse;
    border-radius: 12px;
    overflow: hidden;
    font-size: 14px;
  }
  thead th{
    background: linear-gradient(45deg, var(--brand), var(--brand2));
    color:#fff;
    padding:10px 6px;
    border:1px solid rgba(255,255,255,.35);
    text-align:center;
  }
  td{
    border:1px solid #e7e7e7;
    padding:6px 6px;
    text-align:center;
    white-space: nowrap;
  }
  td.item-name{
    text-align:left;
    white-space: normal;
  }
  td.price s{
    color: #888;
    margin-right: 4px;
  }
  td.price b{
    color: #c62828;
  }
  tbody tr:nth-child(even) td{ background: #fff8e6; }
  tbody tr:nth-child(odd) td{ background: #ffffff; }
  input[type="number"]{
    width:64px;
    padding:4px;
    font-size:13px;
    text-align:center;
    border:1px solid #bbb;
    border-radius:6px;
    outline:none;
  }
  tfoot td{
    font-weight:700;
    background: #ffe082;
  }
  .actions{
    position: sticky;
    bottom: 0;
    background: rgba(0,0,0,0.55);
    padding: 8px 0;
    z-index: 2;
    display: flex;
    gap: 8px;
    justify-content: flex-end;
    flex-wrap: wrap;
    margin-top: 12px;
  }
  .btn{
    appearance:none;
    border:none;
    border-radius: 999px;
    padding:10px 18px;
    font-weight:700;
    cursor:pointer;
    box-shadow: 0 6px 18px rgba(0,0,0,.2);
  }
  .btn-print{ background: linear-gradient(45deg, #1976d2, #26a69a); color:#fff; }
  .btn-save{ background: linear-gradient(45deg, #ef6c00, #fdd835); color:#1a1a1a; }
  .legend{
    text-align:center;
    font-size:12px;
    color:#eee;
    margin-top:8px;
  }

  /* Modal */
  .modal-backdrop{
    position: fixed; inset:0;
    background: rgba(0,0,0,.55);
    display:none; align-items:center; justify-content:center;
    padding: 16px;
    z-index: 10;
  }
  .modal{
    width:95%;
    max-width:520px;
    background: #ffffff;
    color:#111;
    border-radius:14px;
    padding:16px;
    box-shadow: 0 12px 30px rgba(0,0,0,.35);
  }
  .modal h3{ margin: 6px 0 12px; color:#c62828; }
  .field{ margin-bottom:10px; }
  .field label{ display:block; font-size:13px; margin-bottom:4px; }
  .field input, .field textarea{
    width:100%;
    padding:10px;
    border:1px solid #cfcfcf;
    border-radius:10px;
    font-size:14px;
  }
  .modal-actions{
    display:flex; gap:10px; justify-content:flex-end; margin-top:8px;
  }
  .btn-ghost{
    background:#f3f3f3; color:#111;
  }

  /* Mobile adjustments */
  @media screen and (max-width: 768px) {
    header h1 { font-size: 28px; }
    header p { font-size: 12px; }
    table { font-size: 12px; }
    input[type="number"] { width: 50px; font-size: 12px; padding: 3px; }
    .btn { padding: 8px 14px; font-size: 14px; }
  }

  /* Print styles */
  @media print {
    body{ background: none; }
    .wrap{ background: none; box-shadow: none; padding: 0; }
    .legend, .actions, .modal-backdrop{ display:none !important; }
    header h1{ color:#000; text-shadow:none; }
    header p{ color:#000; }
    .card{ box-shadow:none; }
  }
</style>
</head>
<body>

<!-- Happy Diwali Popup -->
<div id="diwaliPopup" class="modal-backdrop" style="display:flex; background:rgba(0,0,0,0.75); align-items:center; justify-content:center;">
  <div class="modal" style="text-align:center; background: linear-gradient(45deg,#ff9800,#d32f2f); color:#fff;">
    <h2 style="margin:0 0 10px;">üéá Happy Diwali! üéÜ</h2>
    <p style="margin:0 0 16px;">Welcome to Tamil Crackers Shop</p>
    <button class="btn btn-save" onclick="closeDiwaliPopup()">‚ú® Celebrate ‚ú®</button>
  </div>
</div>

<div class="wrap">
  <header>
    <h1>üéÜ Tamil Crackers Shop üéá</h1>
    <p>40, Iyyanar Kovil Salai, Palaiyur, Nagapattinam</p>
    <p>üìû 7502921335, 9095621569</p>
  </header>

  <div class="card">
    <table id="priceTable" aria-label="Price List">
      <thead>
        <tr>
          <th>No</th>
          <th>Item Name</th>
          <th>Price (‚Çπ)</th>
          <th>Qty</th>
          <th>Final Price (‚Çπ)</th>
        </tr>
      </thead>
      <tbody></tbody>
      <tfoot>
        <tr>
          <td colspan="4" style="text-align:right">Grand Total</td>
          <td id="grandTotal">0</td>
        </tr>
      </tfoot>
    </table>

    <div class="actions">
<button class="btn btn-save" onclick="downloadPDF()">üìÑ Download PDF</button>


      <button class="btn btn-print" onclick="printOnlyWithQty()">üñ®Ô∏è Print</button>
      <button class="btn btn-save" onclick="openSave()">üíæ Order</button>
    </div>
    <div class="legend">Tip: For background graphics when printing, in Chrome print dialog enable ‚ÄúBackground graphics‚Äù.</div>
  </div>
</div>

<!-- Save Modal -->
<div id="saveModal" class="modal-backdrop" role="dialog" aria-modal="true" aria-labelledby="saveTitle">
  <div class="modal">
    <h3 id="saveTitle">Save & Send Details</h3>
    <div class="field">
      <label for="custName">Name</label>
      <input id="custName" type="text" placeholder="Your name" />
    </div>
    <div class="field">
      <label for="custAddress">Address</label>
      <textarea id="custAddress" rows="3" placeholder="Door No, Street, Area, City, Pincode"></textarea>
    </div>
    <div class="field">
      <label for="custMobile">Mobile Number</label>
      <input id="custMobile" type="tel" placeholder="Your mobile number" />
    </div>
    <div class="modal-actions">
      <button class="btn btn-ghost" onclick="closeSave()">Cancel</button>
      <button class="btn btn-save" onclick="saveAndSend()">Save & Send</button>
    </div>
	
  </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>
<script>
  const ITEMS = [
    ["7cm Sparklers",15],,
    ["10cm Sparklers",22],,["15cm Sparklers",40],
    ["FP big",80],["FB special",90],["FP Small",70],["GC Big (10pcs)",60],
    ["GC Ashoka",100],["1 1/2 Twinkling star",40],["4' Twinkling star",80],
    ["7cm pencil",30],["waterfall pencil",250],["Bigili",20],["kuruvi",10],
    ["4 lakhmi",20],["2 sound",35],["6' laksh",55],["4' inch gold",30],
    ["5' inch gold",35],["6' inch gold",40],["12 shot",250],["60 shot",1200],
    ["120 shot",2000],["28 giant",12],["100 giant",40],["1k wala",200],
    ["2k wala",400],["5k wala",1000],["10k wala",2000],["Star War",150],
    ["Colour Koti",220],["Rocket bomb",100],["color rain",150],
    ["red and green shower",80],["electric stone",20],["kit kat",40],
    ["Jee boomba",20],["cartoon",25],["peacock feather",120],["Mega peacock",200],
    ["Butterfly",150],["pambaram",150],["selfie stick",120],
    ["Diswheel",100],["Fire feather",150],["tin",110],["7 shot",100],
    ["photo flash",60],["Han out",300],["smoke color",150],["siren",240],
    ["peacock red &green",200],["peacock silver",200],["Golden globe",150],
    ["Helicopter",120],["21 items giftbox",500],["31 items giftbox",650]
  ];

  const tbody = document.querySelector("#priceTable tbody");
  ITEMS.forEach((it, i) => {
    const tr = document.createElement("tr");
    const discountedPrice = it[1];
    const mrp = (discountedPrice / 0.5).toFixed(0); // 50% MRP
    tr.innerHTML = `
      <td>${i+1}</td>
      <td class="item-name">${it[0]}</td>
      <td class="price"><s>‚Çπ${mrp}</s> <b>‚Çπ${discountedPrice}</b></td>
      <td><input type="number" min="0" value="0" oninput="updateRow(this)" /></td>
      <td class="finalPrice">0</td>
    `;
    tbody.appendChild(tr);
  });
function downloadPDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  // === Header Background (Top Bar) ===
  doc.setFillColor(211, 47, 47); // deep red
  doc.rect(0, 0, 210, 20, "F");
  doc.setFillColor(255, 152, 0); // orange strip
  doc.rect(0, 20, 210, 5, "F");

  // === Header Text with Emojis ===
  doc.setFontSize(18);
  doc.setTextColor(255, 255, 255);
  doc.text("Tamil Crackers - Price List", 105, 14, { align: "center" });

  // === Prepare Table Data ===
  const rows = [];
  document.querySelectorAll("#priceTable tbody tr").forEach((row, i) => {
    const itemName = row.querySelector(".item-name").textContent.trim();
    let price = row.querySelector(".price b").textContent.trim();
    price = price.replace(/‚Çπ/g, ""); // remove rupee symbol
    rows.push([i + 1, itemName, price]);
  });

  // === Styled Table ===
  doc.autoTable({
    startY: 30,
    head: [["No", "Item Name", "Price"]],
    body: rows,
    theme: "grid",
    headStyles: {
      fillColor: [255, 215, 0],
      textColor: 0,
      fontStyle: "bold",
      halign: "center"
    },
    bodyStyles: {
      textColor: 40,
      fillColor: [255, 255, 255],
      fontSize: 10
    },
    alternateRowStyles: {
      fillColor: [255, 248, 230]
    },
    columnStyles: {
      0: { cellWidth: 15, halign: "center" },
      1: { cellWidth: 120 },
      2: { cellWidth: 40, halign: "right" }
    }
  });

  // === Footer ===
  const finalY = doc.lastAutoTable.finalY + 8;
  doc.setFillColor(255, 215, 0);
  doc.rect(0, finalY, 210, 12, "F");
  doc.setTextColor(0, 0, 0);
  doc.setFontSize(11);
  doc.text("Thank you for shopping with Tamil Crackers! Happy Diwali!", 105, finalY + 8, { align: "center" });

  // === Save PDF ===
  doc.save("Tamil_Crackers_Item_Price.pdf");
}

  function updateRow(input){
    const priceText = input.closest("tr").querySelector(".price b").textContent;
    const price = parseFloat(priceText.replace(/[^0-9.]/g,'')) || 0;
    const qty = parseInt(input.value, 10) || 0;
    input.closest("tr").querySelector(".finalPrice").textContent = (price * qty).toString();
    updateGrandTotal();
  }

  function updateGrandTotal(){
    let total = 0;
    document.querySelectorAll(".finalPrice").forEach(td => { total += parseFloat(td.textContent) || 0; });
    document.getElementById("grandTotal").textContent = total.toString();
  }
function downloadTable() {
  let table = document.getElementById("priceTable");
  let rows = table.querySelectorAll("tr");
  let csv = [];

  rows.forEach(row => {
    let cols = row.querySelectorAll("th, td");
    let rowData = [];
    cols.forEach(col => {
      let text = col.innerText.replace(/\n/g, " ").trim();
      rowData.push('"' + text.replace(/"/g, '""') + '"');
    });
    csv.push(rowData.join(","));
  });

  let csvString = csv.join("\n");
  let blob = new Blob([csvString], { type: "text/csv;charset=utf-8;" });
  let link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "Tamil_Crackers_Price_List.csv";
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

  // Save modal
  function openSave(){ document.getElementById("saveModal").style.display = "flex"; document.getElementById("custName").focus();}
  function closeSave(){ document.getElementById("saveModal").style.display = "none"; }

  function printOnlyWithQty(){
    const rows = document.querySelectorAll("#priceTable tbody tr");
    const hiddenRows = [];
    rows.forEach(r => {
      const qty = parseInt(r.querySelector("input").value || "0", 10);
      if(qty === 0){ r.style.display = "none"; hiddenRows.push(r); }
    });
    window.print();
    hiddenRows.forEach(r => r.style.display = "");
  }

  function buildOrderMessage(name, address){
    const rows = [...document.querySelectorAll("#priceTable tbody tr")];
    const picked = rows.map(r => {
      const name = r.querySelector(".item-name").textContent.trim();
      const price = r.querySelector(".price b").textContent.trim();
      const qty = r.querySelector("input").value.trim();
      const final = r.querySelector(".finalPrice").textContent.trim();
      return {name, price, qty, final};
    }).filter(x => parseInt(x.qty||"0",10) > 0);

    const grand = document.getElementById("grandTotal").textContent.trim();
    let lines = [];
    lines.push("Tamil Crackers Shop - Order");
    lines.push("----------------------------");
    lines.push(`Name: ${name || "-"}`);
    lines.push(`Address: ${address || "-"}`);
    lines.push("");
    lines.push("Items:");
    picked.forEach(p => lines.push(`- ${p.name} | ${p.price} x ${p.qty} = ‚Çπ${p.final}`));
    if(picked.length === 0) lines.push("- (No quantities entered)");
    lines.push("");
    lines.push(`Grand Total: ‚Çπ${grand}`);
    lines.push("");
    lines.push("Thank you!");
    return lines.join("\n");
  }

  function saveAndSend(){
    const name = document.getElementById("custName").value.trim();
    const address = document.getElementById("custAddress").value.trim();
    const msg = buildOrderMessage(name, address);
    const encoded = encodeURIComponent(msg);
    const mailto = `mailto:vidhyasagarg2001@gmail.com?subject=${encodeURIComponent("Tamil Crackers Order")}&body=${encoded}`;
    const wa = `https://wa.me/7502921335?text=${encoded}`;
    window.open(wa, "_blank");
    window.location.href = mailto;
    closeSave();
  }

  // Happy Diwali popup
  function closeDiwaliPopup() {
    document.getElementById('diwaliPopup').style.display = 'none';
  }
  window.addEventListener('load', () => {
    setTimeout(closeDiwaliPopup, 5000);
  });
</script>
</body>
</html>
